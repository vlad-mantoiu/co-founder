---
milestone: v0.3
audited: 2026-02-20T11:00:00Z
status: passed
scores:
  requirements: 16/16
  phases: 4/4
  integration: 14/14
  flows: 4/4
gaps:
  requirements: []
  integration: []
  flows: []
tech_debt:
  - phase: 19-cloudfront-s3-infrastructure
    items:
      - "Stale documentation: 19-VERIFICATION.md references old .html rewrite pattern; code correctly uses /index.html (fixed in Phase 20 commit 919a7d9)"
  - phase: 20-app-cleanup
    items:
      - "Dashboard layout retains force-dynamic for useSearchParams() — documented deviation, technically necessary, not a debt to resolve"
advisories:
  - requirement: MKT-03
    note: "Pricing CTA query-param preservation (?plan=&interval=) through Clerk sign-up flow is runtime-dependent on Clerk default behavior — not configurable via code, not a wiring break"
---

# v0.3 Marketing Separation — Milestone Audit

**Audited:** 2026-02-20
**Status:** PASSED
**Score:** 16/16 requirements satisfied | 4/4 phases passed | 14/14 integrations wired | 4/4 E2E flows complete

---

## Milestone Definition of Done

> Separate static marketing pages from the authenticated app so marketing loads instantly without Clerk overhead, and the parent brand (getinsourced.ai) has its own fast static site on CloudFront + S3.

**Verdict:** Achieved. Marketing site is live at getinsourced.ai on CloudFront + S3 with zero Clerk JS. Authenticated app at cofounder.getinsourced.ai serves only app routes. CI/CD pipeline deploys marketing on push.

---

## Phase Verification Summary

| Phase | Goal | Status | Score | Key Evidence |
|-------|------|--------|-------|-------------|
| 18 — Marketing Site Build | Static marketing site with all pages | PASSED | 13/13 | 8 static HTML pages in /out, zero Clerk references, multi-product structure |
| 19 — CloudFront + S3 Infrastructure | CDK stack for hosting | PASSED | 5/5 | CoFounderMarketing CREATE_COMPLETE, HTTPS live, OAC enforced, www redirect working |
| 20 — App Cleanup | Strip marketing from app | PASSED | 7/7 | Marketing routes deleted, redirects to getinsourced.ai, root auth-aware redirect, middleware narrowed |
| 21 — Marketing CI/CD | Automated deploy pipeline | PASSED | 4/4 | deploy-marketing.yml with path filter, IAM permissions scoped, manual trigger available |

---

## Requirements Coverage (3-Source Cross-Reference)

| REQ-ID | Description | VERIFICATION.md | SUMMARY Frontmatter | REQUIREMENTS.md | Final Status |
|--------|-------------|-----------------|---------------------|-----------------|--------------|
| MKT-01 | Parent brand landing at getinsourced.ai, zero Clerk JS | Phase 18: SATISFIED | 18-03-SUMMARY | [x] Complete | **satisfied** |
| MKT-02 | Co-Founder product page at /cofounder | Phase 18: SATISFIED | 18-03-SUMMARY | [x] Complete | **satisfied** |
| MKT-03 | Pricing page with CTAs to cofounder.getinsourced.ai | Phase 18: SATISFIED | 18-04-SUMMARY | [x] Complete | **satisfied** |
| MKT-04 | About, contact, privacy, terms pages | Phase 18: SATISFIED | 18-04-SUMMARY | [x] Complete | **satisfied** |
| MKT-05 | Next.js static export in /marketing | Phase 18: SATISFIED | 18-01-SUMMARY | [x] Complete | **satisfied** |
| MKT-06 | Multi-product structure ({product} pattern) | Phase 18: SATISFIED | 18-02, 18-03-SUMMARY | [x] Complete | **satisfied** |
| INFRA-01 | CloudFront + S3 hosting | Phase 19: SATISFIED | 19-01, 19-02-SUMMARY | [x] Complete | **satisfied** |
| INFRA-02 | CDK stack provisions S3, CloudFront, Route53 | Phase 19: SATISFIED | 19-01, 19-02-SUMMARY | [x] Complete | **satisfied** |
| INFRA-03 | ACM certificate for getinsourced.ai + www | Phase 19: SATISFIED | 19-01, 19-02-SUMMARY | [x] Complete | **satisfied** |
| INFRA-04 | S3 private with OAC | Phase 19: SATISFIED | 19-01, 19-02-SUMMARY | [x] Complete | **satisfied** |
| APP-01 | Root redirects to /dashboard or /sign-in | Phase 20: SATISFIED | 20-01, 20-02-SUMMARY | [x] Complete | **satisfied** |
| APP-02 | Marketing route group removed | Phase 20: SATISFIED | 20-01, 20-02-SUMMARY | [x] Complete | **satisfied** |
| APP-03 | force-dynamic removed from unnecessary routes | Phase 20: SATISFIED | 20-01, 20-02-SUMMARY | [x] Complete | **satisfied** |
| APP-04 | Clerk middleware narrowed | Phase 20: SATISFIED | 20-01, 20-02-SUMMARY | [x] Complete | **satisfied** |
| CICD-01 | GitHub Actions deploys to S3 + invalidates CloudFront | Phase 21: SATISFIED | 21-01-SUMMARY | [x] Complete | **satisfied** |
| CICD-02 | Path-filtered to /marketing only | Phase 21: SATISFIED | 21-01-SUMMARY | [x] Complete | **satisfied** |

**Orphaned requirements:** 0 (all 16 REQ-IDs present in at least one phase VERIFICATION.md)
**Unsatisfied requirements:** 0

---

## Cross-Phase Integration

**14 connections verified, 0 orphaned, 0 missing.**

| From | To | Connection | Status |
|------|----|-----------|--------|
| Phase 18 (marketing/out/) | Phase 19 (S3 getinsourced-marketing) | aws s3 sync | WIRED |
| Phase 18 (marketing/) | Phase 21 (CI npm run build) | package.json build script | WIRED |
| Phase 19 (S3 bucket name) | Phase 21 (deploy-marketing.yml) | Hardcoded `getinsourced-marketing` | WIRED |
| Phase 19 (CloudFront dist ID) | Phase 21 (deploy-marketing.yml) | Hardcoded `E1BF4KDBGHEQPX` | WIRED |
| Phase 19 (CloudFront dist ID) | Phase 21 (IAM MarketingCFInvalidation) | ARN scoped policy | WIRED |
| Phase 19 (Route53 getinsourced.ai) | Phase 20 (next.config.ts redirects) | Redirect destinations resolve to CF | WIRED |
| Phase 19 (url-handler.js) | Phase 18 (out/path/index.html) | CF Function /path → /path/index.html | WIRED |
| Phase 20 (next.config.ts redirects) | Phase 18 (marketing/out/) | 5 redirect targets exist in /out | WIRED |
| Phase 20 (middleware.ts) | Phase 20 (/dashboard, /sign-in) | auth-aware root redirect | WIRED |
| Phase 18 (navbar CTA /signin) | Phase 20 (/signin → /sign-in redirect) | Redirect chain to Clerk | WIRED |
| Phase 18 (getPricingHref) | Phase 20 (CheckoutAutoRedirector) | /dashboard?plan= query params | WIRED |
| Phase 21 (OIDC auth) | Phase 17 (cofounder-github-deploy role) | aws-actions/configure-aws-credentials | WIRED |
| Phase 19 (MarketingStack Route53) | Phase 19 (ComputeStack cleanup) | No conflicting records | WIRED |
| Phase 18 (trailingSlash: true) | Phase 19 (url-handler.js) | index.html structure matches CF Function | WIRED |

---

## E2E Flow Verification

### Flow 1: New Visitor → Sign-Up
```
Google → getinsourced.ai → CloudFront → S3 index.html → marketing site
  Browse /cofounder, /pricing → CF Function rewrites to /index.html
  Click "Start Building" → cofounder.getinsourced.ai/onboarding
  Middleware: isProtectedRoute → auth.protect() → Clerk sign-in/sign-up
  After auth → /onboarding served from (dashboard) route group
```
**Status:** COMPLETE

### Flow 2: Returning User → Dashboard
```
cofounder.getinsourced.ai/ → middleware: pathname === '/' → await auth()
  Authenticated → redirect /dashboard
  Unauthenticated → redirect /sign-in
```
**Status:** COMPLETE

### Flow 3: Marketing Deploy (CI/CD)
```
git push (touches marketing/**) → GitHub Actions triggers
  deploy-marketing.yml: checkout → node 20 → npm ci → npm run build
  aws s3 sync marketing/out/ s3://getinsourced-marketing/ --delete
  aws cloudfront create-invalidation E1BF4KDBGHEQPX /*
  Path filter: /backend or /frontend changes do NOT trigger
```
**Status:** COMPLETE

### Flow 4: Old Bookmark Redirect
```
cofounder.getinsourced.ai/pricing → next.config.ts permanent redirect
  → https://getinsourced.ai/pricing → CloudFront → S3 pricing page
  Same pattern for /about, /contact, /privacy, /terms
```
**Status:** COMPLETE

---

## Tech Debt

### Phase 19: Stale Documentation
19-VERIFICATION.md references old `.html` rewrite pattern in evidence notes. The actual `url-handler.js` correctly uses `/index.html` (fixed in Phase 20 commit `919a7d9`). Documentation-only — no code impact.

### Phase 20: Dashboard force-dynamic Retained
Dashboard layout keeps `force-dynamic` because child pages use `useSearchParams()` which requires it. Documented deviation from plan. Root layout `force-dynamic` was removed as intended. Not a debt to resolve — technically correct.

### Advisory: Pricing CTA Clerk Flow
Pricing CTAs link to `cofounder.getinsourced.ai/dashboard?plan={slug}&interval={interval}`. For unauthenticated users, Clerk's `auth.protect()` redirects to `/sign-in` with a `redirect_url`. Query param preservation through the full Clerk sign-up flow is runtime-dependent on Clerk's default behavior. Not a wiring break — an untestable edge case.

**Total tech debt: 2 items (both non-critical, 1 documentation-only)**

---

## Human Verification Items (Deferred to Runtime)

These items were flagged by phase verifiers as requiring browser/runtime confirmation:

| Phase | Item | Status |
|-------|------|--------|
| 18 | Navbar brand switching (pathname-based client-side) | Verified in Phase 20 browser checkpoint |
| 18 | Pricing annual toggle | Deferred — client-side useState |
| 18 | FadeIn animations | Deferred — IntersectionObserver |
| 19 | Clean URL rewriting at /about, /pricing | Verified live via curl |
| 19 | Branded 404 page | Deferred — requires visual confirmation |
| 20 | All 10 browser verification steps | APPROVED by user in Phase 20 Plan 02 |
| 21 | Marketing push triggers deploy workflow | Deferred — requires real push to main |
| 21 | Non-marketing push does NOT trigger | Deferred — requires observing GitHub Actions |

---

_Audited: 2026-02-20_
_Auditor: Claude (milestone audit orchestrator)_
