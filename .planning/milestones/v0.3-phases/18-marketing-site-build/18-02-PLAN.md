---
phase: 18-marketing-site-build
plan: 02
type: execute
wave: 2
depends_on: [18-01]
files_modified:
  - marketing/src/components/marketing/navbar.tsx
  - marketing/src/components/marketing/footer.tsx
  - marketing/src/app/(marketing)/layout.tsx
  - marketing/src/app/(marketing)/page.tsx
autonomous: true
requirements: [MKT-06]

must_haves:
  truths:
    - "Navbar renders Insourced branding ONLY on pathname === '/' and Co-Founder branding on ALL other pages (including /pricing, /about, /contact, /privacy, /terms)"
    - "Footer uses identical branding logic: isInsourced = pathname === '/'"
    - "Navbar 'Start Building' CTA links to https://cofounder.getinsourced.ai/onboarding"
    - "Navbar 'Sign In' link goes to https://cofounder.getinsourced.ai/signin"
    - "Co-Founder nav links point to /cofounder/#features and /cofounder/how-it-works"
    - "Co-Founder pages show subtle 'by Insourced AI' link beneath logo"
    - "Footer is a 'use client' component using usePathname() — not an async server component"
    - "Running `npm run build` in /marketing produces a /marketing/out directory with static HTML files"
    - "No ClerkProvider, no @clerk/* imports, no next/headers imports anywhere in /marketing"
  artifacts:
    - path: "marketing/src/components/marketing/navbar.tsx"
      provides: "Context-aware navbar with pathname-based branding"
      contains: "usePathname"
    - path: "marketing/src/components/marketing/footer.tsx"
      provides: "Client-side footer with pathname-based branding"
      contains: "use client"
    - path: "marketing/src/app/(marketing)/layout.tsx"
      provides: "Marketing layout wrapper with Navbar and Footer"
      contains: "Navbar"
    - path: "marketing/src/app/(marketing)/page.tsx"
      provides: "Placeholder home page for build verification"
  key_links:
    - from: "marketing/src/components/marketing/navbar.tsx"
      to: "https://cofounder.getinsourced.ai/onboarding"
      via: "Start Building CTA href"
      pattern: "cofounder\\.getinsourced\\.ai/onboarding"
    - from: "marketing/src/components/marketing/footer.tsx"
      to: "marketing/src/components/marketing/navbar.tsx"
      via: "Both use usePathname() for brand detection — identical isInsourced = pathname === '/' pattern"
      pattern: "pathname === \"/\""
    - from: "marketing/src/app/(marketing)/layout.tsx"
      to: "marketing/src/components/marketing/navbar.tsx"
      via: "Import and render Navbar in layout wrapper"
      pattern: "Navbar"
---

<objective>
Create context-aware Navbar and Footer components, the marketing layout wrapper, and verify the build.

Purpose: These shared UI components implement the context-aware branding pattern (Insourced on root `/`, Co-Founder on all other pages per locked decision). The layout wrapper ensures every page gets Navbar + Footer. A build verification confirms the static export works.

Output: Navbar, Footer, (marketing) layout wrapper, placeholder home page, and a verified static build.
</objective>

<execution_context>
@/Users/vladcortex/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vladcortex/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-marketing-site-build/18-RESEARCH.md
@.planning/phases/18-marketing-site-build/18-CONTEXT.md
@.planning/phases/18-marketing-site-build/18-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create context-aware Navbar</name>
  <files>
    marketing/src/components/marketing/navbar.tsx
  </files>
  <action>
Copy `frontend/src/components/marketing/navbar.tsx` to `marketing/src/components/marketing/navbar.tsx` and apply these modifications:

**1. Replace hostname-based brand detection with pathname-based (FIXED per locked decision):**
The marketing site is deployed on a single domain (getinsourced.ai), so hostname detection is useless. Use `usePathname()` instead.

Per locked decision: "Shared pages (pricing, about, contact, privacy, terms) use Co-Founder branding — since it's the only live product." This means ONLY the root page (`/`) shows Insourced branding. All other pages show Co-Founder branding.

```typescript
const pathname = usePathname();
const isInsourced = pathname === "/";
const isCofounder = !isInsourced;
```

Remove the `INSOURCED_HOSTS` array and the `window.location.hostname` useEffect. Remove the `isInsourced` state variable — replace with the derived constant above.

**2. Update nav links for Co-Founder pages:**
Change `cofounderLinks` to:
```typescript
const cofounderLinks = [
  { href: "/cofounder/#features", label: "Features" },
  { href: "/cofounder/how-it-works", label: "How It Works" },
  { href: "/pricing", label: "Pricing" },
  { href: "/about", label: "About" },
];
```
The `insourcedLinks` stay the same (they are relative paths within the marketing site).

**3. Update brand name and add "by Insourced AI" link:**
When `isCofounder`:
- Brand name: `Co-Founder.ai`
- Logo links to `/cofounder` (not `/`)
- Add subtle "by Insourced AI" text/link beneath the logo that links to `/`
When `isInsourced` (only on `/`):
- Brand name: `getinsourced.ai`
- Logo links to `/`

**4. Fix CTA links — ALL must be external full URLs:**
- "Sign In" -> `https://cofounder.getinsourced.ai/signin`
- "Start Building" -> `https://cofounder.getinsourced.ai/onboarding`
Use `<a href>` tags instead of `<Link>` for external URLs (Link is for internal routing).

**5. Fix isActive helper:**
Update to handle `/cofounder` prefix correctly. For insourced pages `pathname === "/"` still works. For cofounder hash links, check if pathname starts with `/cofounder` and the href starts with `/cofounder/#`.

**6. Handle usePathname() SSG safety (Pitfall 7):**
`usePathname()` works during static export — Next.js pre-renders each page with its known path. However, for hydration safety, use the pathname directly from the hook rather than window.location.
  </action>
  <verify>
1. Grep for `window.location.hostname` in marketing/src/components/marketing/navbar.tsx — zero matches
2. Grep for `INSOURCED_HOSTS` in marketing/src/components/marketing/navbar.tsx — zero matches
3. Grep for `cofounder.getinsourced.ai/onboarding` in the file — at least 1 match
4. Grep for `cofounder.getinsourced.ai/signin` in the file — at least 1 match
5. Grep for `/sign-up` (bare path without full URL) — zero matches
6. Grep for `usePathname` — at least 1 match
7. Grep for `pathname === "/"` — at least 1 match (confirms correct branding logic)
  </verify>
  <done>Navbar adapted with pathname-based branding (isInsourced = pathname === "/"), external CTA links, updated Co-Founder nav links, and "by Insourced AI" subtle link.</done>
</task>

<task type="auto">
  <name>Task 2: Create context-aware Footer</name>
  <files>
    marketing/src/components/marketing/footer.tsx
  </files>
  <action>
Rewrite `frontend/src/components/marketing/footer.tsx` as a `"use client"` component. The existing footer is an async server component that uses `headers()` from `next/headers` — this is incompatible with `output: 'export'`.

**Critical changes:**
1. Add `"use client"` directive at the top
2. Remove `async` from the function declaration — it's no longer an async server component
3. Remove `import { headers } from "next/headers"` entirely
4. Replace hostname detection with pathname-based detection, using the SAME logic as Navbar:
```typescript
import { usePathname } from "next/navigation";

export function Footer() {
  const pathname = usePathname();
  const isInsourced = pathname === "/";
  const isCofounder = !isInsourced;
```

This is identical to the Navbar logic and honors the locked decision: "Shared pages (pricing, about, contact, privacy, terms) use Co-Founder branding."

5. Update footer link sections:
   - For Co-Founder footer: Change `{ label: "How It Works", href: "/#how-it-works" }` to `{ label: "How It Works", href: "/cofounder/how-it-works" }`
   - For Co-Founder footer: Change `{ label: "Features", href: "/#features" }` to `{ label: "Features", href: "/cofounder/#features" }`
   - For Insourced footer: The "Co-Founder" link should go to `/cofounder` (internal) instead of `https://cofounder.getinsourced.ai`

6. Keep all social links and the copyright section as-is.
  </action>
  <verify>
1. Grep for `next/headers` in marketing/src/components/marketing/footer.tsx — zero matches
2. Grep for `async` in the export function line — zero matches
3. First line is `"use client"`
4. Grep for `usePathname` — at least 1 match
5. Grep for `/cofounder/how-it-works` — at least 1 match
6. Grep for `pathname === "/"` — at least 1 match (confirms identical branding logic to Navbar)
  </verify>
  <done>Footer rewritten as client component with pathname-based branding (isInsourced = pathname === "/"), no server APIs.</done>
</task>

<task type="auto">
  <name>Task 3: Create marketing layout wrapper and verify build</name>
  <files>
    marketing/src/app/(marketing)/layout.tsx
    marketing/src/app/(marketing)/page.tsx
  </files>
  <action>
Create a marketing layout that wraps all pages with Navbar and Footer — equivalent to `frontend/src/app/(marketing)/layout.tsx`:

```typescript
import { Navbar } from "@/components/marketing/navbar";
import { Footer } from "@/components/marketing/footer";

export default function MarketingLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div className="font-display min-h-screen bg-obsidian text-white">
      <Navbar />
      <main>{children}</main>
      <Footer />
    </div>
  );
}
```

IMPORTANT DECISION: The route group approach. All content pages should live under `app/(marketing)/` to get the Navbar/Footer wrapper. This matches the frontend pattern. The `(marketing)` route group does NOT affect the URL — `app/(marketing)/pricing/page.tsx` still serves `/pricing`.

Also create a minimal placeholder home page so the build can succeed:
```typescript
// marketing/src/app/(marketing)/page.tsx
export default function HomePage() {
  return <div>Insourced AI — Coming in Plan 03</div>;
}
```

Then run `cd /Users/vladcortex/co-founder/marketing && npm run build` to verify the static export produces an `/out` directory without errors.

**Expected build issues and fixes:**
- If `globals.css` references Tailwind v4 `@import "tailwindcss"` syntax, ensure the postcss config handles it
- If any import path is wrong, fix it
- The build must succeed with zero errors

After successful build, verify:
1. `/marketing/out/index.html` exists
2. No Clerk JS references in any HTML file in `/out`
  </action>
  <verify>
1. `ls /Users/vladcortex/co-founder/marketing/out/index.html` exists
2. `grep -r "clerk" /Users/vladcortex/co-founder/marketing/out/ --include="*.html" --include="*.js" | wc -l` — zero matches
3. Build exit code is 0
  </verify>
  <done>Marketing site builds successfully to /out as a fully static export. Zero Clerk dependencies in output.</done>
</task>

</tasks>

<verification>
1. `cd /Users/vladcortex/co-founder/marketing && npm run build` exits with code 0
2. `/marketing/out/index.html` exists (static export worked)
3. `grep -r "clerk" /Users/vladcortex/co-founder/marketing/out/ --include="*.html" --include="*.js"` — zero matches
4. `grep -r "next/headers" /Users/vladcortex/co-founder/marketing/src/` — zero matches
5. `grep -r "force-dynamic" /Users/vladcortex/co-founder/marketing/src/` — zero matches
6. Navbar shows Insourced branding ONLY on `/`, Co-Founder branding on all other pages
7. Footer uses identical `isInsourced = pathname === "/"` logic
</verification>

<success_criteria>
- Navbar and Footer are context-aware using usePathname() with `isInsourced = pathname === "/"`
- Shared pages (/pricing, /about, /contact, /privacy, /terms) get Co-Founder branding per locked decision
- All CTAs link to cofounder.getinsourced.ai with correct paths
- Marketing layout wrapper renders Navbar + Footer around all pages
- `npm run build` produces a static /out directory
- Zero Clerk JS in the output HTML/JS
</success_criteria>

<output>
After completion, create `.planning/phases/18-marketing-site-build/18-02-SUMMARY.md`
</output>
