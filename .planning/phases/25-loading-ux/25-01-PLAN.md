---
phase: 25-loading-ux
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - marketing/src/components/marketing/loading/splash-screen.tsx
  - marketing/src/app/layout.tsx
  - marketing/src/app/globals.css
autonomous: true
requirements: [LOAD-01, LOAD-02, LOAD-03]

must_haves:
  truths:
    - "On first visit, a branded splash overlay with SVG logo draw animation is visible before page content appears"
    - "After the logo draw animation completes, the logo shrinks toward the header position and the overlay fades out smoothly"
    - "On subsequent visits within the same browser session, the splash does not appear"
    - "If the browser has prefers-reduced-motion enabled, the splash still shows but animations are instant (per MotionConfig)"
  artifacts:
    - path: "marketing/src/components/marketing/loading/splash-screen.tsx"
      provides: "Client component: SVG draw animation, dismiss sequence, sessionStorage guard"
      min_lines: 60
    - path: "marketing/src/app/layout.tsx"
      provides: "Pre-hydration inline script for sessionStorage check + SplashScreen integration"
      contains: "dangerouslySetInnerHTML"
    - path: "marketing/src/app/globals.css"
      provides: "Splash overlay CSS + no-splash suppression rule"
      contains: "data-no-splash"
  key_links:
    - from: "marketing/src/app/layout.tsx"
      to: "marketing/src/components/marketing/loading/splash-screen.tsx"
      via: "SplashScreen component rendered in body"
      pattern: "<SplashScreen"
    - from: "marketing/src/app/layout.tsx inline script"
      to: "marketing/src/app/globals.css"
      via: "data-no-splash attribute hides #splash-overlay"
      pattern: "data-no-splash"
---

<objective>
Implement a branded splash screen that renders instantly before JavaScript executes, plays a logo SVG draw animation, then dismisses with the logo shrinking toward the header position. The splash is suppressed on repeat visits within the same browser session via sessionStorage.

Purpose: First-time visitors experience a premium, crafted loading moment. Repeat visitors skip directly to content with zero overhead.
Output: splash-screen.tsx component, updated root layout.tsx with inline script, CSS rules in globals.css.
</objective>

<execution_context>
@/Users/vladcortex/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vladcortex/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-loading-ux/25-RESEARCH.md
@marketing/src/app/layout.tsx
@marketing/src/app/(marketing)/layout.tsx
@marketing/src/app/globals.css
@marketing/src/components/marketing/navbar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create splash screen component and CSS</name>
  <files>
    marketing/src/components/marketing/loading/splash-screen.tsx
    marketing/src/app/globals.css
  </files>
  <action>
Create `marketing/src/components/marketing/loading/` directory and `splash-screen.tsx`:

**splash-screen.tsx** — "use client" component:

1. State management:
   - `const [visible, setVisible] = useState(false)` — starts false to avoid hydration mismatch (server-rendered HTML has no splash state). Set to true in useEffect.
   - `const [phase, setPhase] = useState<'drawing' | 'dismissing' | 'done'>('drawing')`

2. useEffect on mount:
   - Check `sessionStorage.getItem('gi-splash')` — if set, return early (don't show). The inline script in layout.tsx already hides the CSS overlay; this is the React-side guard.
   - If NOT set: `sessionStorage.setItem('gi-splash', '1')`, then `setVisible(true)`

3. SVG draw animation (framer-motion):
   - Render an inline SVG matching the Terminal icon from lucide-react. The Terminal icon is a rectangle with rounded corners (the terminal window) and a chevron/angle-bracket inside (the prompt cursor). Use these SVG paths:
     - `motion.rect` — x="2" y="3" width="20" height="14" rx="2" (terminal window frame)
     - `motion.polyline` — points="8 10 12 14" (the `>_` terminal prompt chevron)
     - `motion.line` — x1="16" y1="14" x2="19" y2="14" (the underscore cursor)
   - All with `strokeDasharray="0 1"` to prevent flicker (CRITICAL per research).
   - Use variants pattern for staggered draw:
     ```
     const draw = {
       hidden: { pathLength: 0, opacity: 0 },
       visible: (delay: number) => ({
         pathLength: 1, opacity: 1,
         transition: { pathLength: { delay, type: "spring", duration: 1.0, bounce: 0 }, opacity: { delay, duration: 0.01 } }
       })
     };
     ```
   - Rect draws first (custom={0}), polyline second (custom={0.3}), line third (custom={0.5}).
   - SVG size: width={80} height={56} viewBox="0 0 24 20", stroke color `#6467f2`, strokeWidth={1.5}, fill="none", strokeLinecap="round", strokeLinejoin="round".

4. Dismiss sequence (after draw completes):
   - After ~1.2s (draw animation complete), transition to `dismissing` phase.
   - In dismiss phase, animate the centered logo: `scale(0.35)` and `y: -45vh, x: -38vw` (toward top-left header logo position). Use framer-motion `animate` prop with transition `duration: 0.5, ease: [0.4, 0, 0.2, 1]`.
   - Simultaneously animate the overlay: `opacity: 0` over 0.4s.
   - Use `onAnimationComplete` on the overlay exit to set phase to `done`, then `setVisible(false)`.

5. Render structure:
   - Wrap in `AnimatePresence` (imported from framer-motion).
   - Only render when `visible && phase !== 'done'`.
   - Outer: `motion.div` with id="splash-overlay", className="fixed inset-0 z-[9999] flex items-center justify-center", background: use `bg-obsidian` (solid dark, #050505 — discretion choice: solid dark matches existing site aesthetic).
   - Exit animation: `exit={{ opacity: 0 }}` with `transition={{ duration: 0.4 }}`.

**globals.css additions** (add BEFORE the reduced-motion media query block, after the existing `.hero-fade-delayed` block):

```css
/* Splash screen — hidden on repeat visits via pre-hydration script */
[data-no-splash] #splash-overlay {
  display: none !important;
}
```

That's all the CSS needed — the splash itself is styled with Tailwind utility classes in the component.
  </action>
  <verify>
Run `cd /Users/vladcortex/co-founder/marketing && npm run build` — build succeeds with no errors. Verify the file `marketing/src/components/marketing/loading/splash-screen.tsx` exists and exports `SplashScreen`. Verify globals.css contains `[data-no-splash]` rule.
  </verify>
  <done>
SplashScreen component exists with SVG draw animation using framer-motion pathLength, sessionStorage guard, dismiss animation (scale + translate toward header), and AnimatePresence exit. CSS rule hides splash on repeat visits via data attribute.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire splash into root layout with pre-hydration script</name>
  <files>
    marketing/src/app/layout.tsx
  </files>
  <action>
Modify `marketing/src/app/layout.tsx`:

1. Import `SplashScreen` from `@/components/marketing/loading/splash-screen`.

2. Add an inline `<script>` tag inside `<head>` (AFTER the existing JSON-LD script tags) using `dangerouslySetInnerHTML`. This script runs before React hydration:
   ```tsx
   <script
     dangerouslySetInnerHTML={{
       __html: `(function(){try{if(sessionStorage.getItem('gi-splash')){document.documentElement.setAttribute('data-no-splash','')}}catch(e){}})();`,
     }}
   />
   ```
   This sets `data-no-splash` on `<html>` if sessionStorage flag exists, which triggers the CSS `display:none` rule on `#splash-overlay`. No hydration mismatch — the script manipulates `<html>` attributes, not React-controlled DOM.

3. Add `<SplashScreen />` as the FIRST child inside `<body>`, BEFORE `{children}`:
   ```tsx
   <body className={`${GeistSans.variable} ${GeistMono.variable} ${spaceGrotesk.variable} antialiased`}>
     <SplashScreen />
     {children}
   </body>
   ```

   Place splash in ROOT layout (not marketing layout) so it persists across SPA navigations and doesn't remount — per research pitfall #6.

IMPORTANT: The root layout.tsx is a SERVER component (no "use client"). Importing a client component into a server component is fine — Next.js handles the boundary automatically. Do NOT add "use client" to layout.tsx.
  </action>
  <verify>
Run `cd /Users/vladcortex/co-founder/marketing && npm run build` — build succeeds. Check that `out/index.html` contains the inline sessionStorage script in `<head>`. Check that `out/index.html` contains `id="splash-overlay"` or the SplashScreen's rendered output (it will be minimal since it's a client component, but the script tag should be present). Run `npx serve out -l 3333` in background and confirm the page loads without errors.
  </verify>
  <done>
Root layout.tsx has pre-hydration inline script checking sessionStorage and setting data-no-splash attribute. SplashScreen component is rendered first in body. Build passes. First visit shows splash with draw animation then dismiss. Repeat visits within session skip splash entirely (both CSS-hidden and React-guarded).
  </done>
</task>

</tasks>

<verification>
1. `cd /Users/vladcortex/co-founder/marketing && npm run build` passes with zero errors
2. `grep -c 'gi-splash' out/index.html` returns at least 1 (inline script present in built HTML)
3. `grep -c 'splash-overlay' out/index.html` returns at least 1 (splash div present)
4. `grep -c 'data-no-splash' marketing/src/app/globals.css` returns 1 (CSS suppression rule)
5. File `marketing/src/components/marketing/loading/splash-screen.tsx` exists and is > 60 lines
</verification>

<success_criteria>
- SplashScreen component renders a full-screen overlay with SVG logo draw animation using framer-motion pathLength
- Splash dismisses by animating logo toward header position then fading overlay
- sessionStorage flag ('gi-splash') prevents splash on repeat visits within same session
- Pre-hydration inline script in <head> sets data-no-splash attribute for CSS-level suppression before React boots
- Build passes clean with no hydration warnings
</success_criteria>

<output>
After completion, create `.planning/phases/25-loading-ux/25-01-SUMMARY.md`
</output>
