---
phase: 08-understanding-interview-decision-gates
plan: 06
type: execute
wave: 3
depends_on: ["08-04", "08-05"]
files_modified:
  - frontend/src/app/(dashboard)/understanding/page.tsx
  - frontend/src/components/understanding/IdeaBriefView.tsx
  - frontend/src/app/(dashboard)/company/page.tsx
autonomous: false

must_haves:
  truths:
    - "Understanding interview flows into Decision Gate 1 seamlessly"
    - "Decision Gate resolution routes to appropriate next step"
    - "Proceed path shows execution plan comparison table"
    - "Deep Research button visible but returns 402 with upgrade message"
    - "Dashboard reflects understanding interview completion and gate status"
    - "Full founder flow works: interview -> brief -> gate -> plan selection"
  artifacts:
    - path: "frontend/src/app/(dashboard)/understanding/page.tsx"
      provides: "Complete understanding page with gate and plan integration"
    - path: "frontend/src/components/understanding/IdeaBriefView.tsx"
      provides: "Brief view with Deep Research button and gate trigger"
  key_links:
    - from: "frontend/src/app/(dashboard)/understanding/page.tsx"
      to: "frontend/src/components/decision-gates/DecisionGateModal.tsx"
      via: "Modal triggered after brief completion"
      pattern: "DecisionGateModal"
    - from: "frontend/src/app/(dashboard)/understanding/page.tsx"
      to: "frontend/src/components/execution-plans/PlanComparisonTable.tsx"
      via: "Table shown after Proceed decision"
      pattern: "PlanComparisonTable"
---

<objective>
Wire the full Phase 8 flow together: understanding interview -> Idea Brief -> Decision Gate 1 -> Execution Plan selection. Add Deep Research stub button and update dashboard to reflect new state.

Purpose: Connect all the Phase 8 components into a seamless founder experience. The flow must feel natural: complete the interview, review the brief, make a gate decision, then choose a build path. Each step transitions smoothly to the next.

Output: Integrated understanding page with gate + plan flow, Deep Research button, dashboard updates, visual verification
</objective>

<execution_context>
@/Users/vladcortex/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vladcortex/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-understanding-interview-decision-gates/08-CONTEXT.md
@.planning/phases/08-understanding-interview-decision-gates/08-RESEARCH.md

@.planning/phases/08-understanding-interview-decision-gates/08-04-SUMMARY.md
@.planning/phases/08-understanding-interview-decision-gates/08-05-SUMMARY.md

@frontend/src/app/(dashboard)/understanding/page.tsx
@frontend/src/components/understanding/IdeaBriefView.tsx
@frontend/src/app/(dashboard)/company/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire Full Flow + Deep Research Button + Dashboard Integration</name>
  <files>
    frontend/src/app/(dashboard)/understanding/page.tsx
    frontend/src/components/understanding/IdeaBriefView.tsx
    frontend/src/app/(dashboard)/company/page.tsx
  </files>
  <action>
1. Update `app/(dashboard)/understanding/page.tsx` to integrate the full flow:
   - After "viewing_brief" phase, show "Ready to decide?" CTA that opens DecisionGateModal
   - Pass brief summary to DecisionGateModal for context display
   - On gate resolution:
     - "proceed": Transition to execution plan view. Auto-generate plans. Show PlanComparisonTable + PlanOptionCards. After selection, show success message with "Go to Dashboard" button.
     - "narrow": Show loading state while brief regenerates, then return to viewing_brief with updated brief
     - "pivot": Show loading state while brief regenerates, then return to viewing_brief with new brief version
     - "park": Show "Project parked" confirmation with note. Show "Return to Dashboard" button.
   - Add new phases to the page rendering: "gate_open" | "plan_selection" | "plan_selected" | "parked"
   - Phase-based rendering:
     - "gate_open": DecisionGateModal is open (full-screen, blocks everything)
     - "plan_selection": PlanComparisonTable + PlanOptionCards + "Generate Different Options" button
     - "plan_selected": Success state with selected plan summary + "Continue to Dashboard" button
     - "parked": Parked confirmation with note and dashboard link

2. Update `components/understanding/IdeaBriefView.tsx`:
   - Add "Deep Research" button below the brief sections. On click, POST /api/plans/{projectId}/deep-research. Catch 402 response and show toast/banner: "Deep Research requires CTO tier. Upgrade to unlock market research, competitor analysis, and technical feasibility reports." (per UNDR-06). Use a muted/disabled-looking button with a lock icon (lucide Lock) to signal it's gated. Include "CTO Tier" badge next to button text.
   - Add "Proceed to Decision" CTA button at bottom of brief view (primary action)
   - Ensure re-interview button is also visible for major changes

3. Update company dashboard page (`app/(dashboard)/company/page.tsx` or the relevant dashboard page):
   - If project has a pending decision gate, show a banner/card: "Decision Gate 1 is pending. Make your decision to continue." with a link to /understanding
   - If project has completed understanding interview but no brief, show "Understanding interview in progress" status
   - If project has a parked status, show "Parked" badge with park note
   - This integrates Phase 8 state into the existing dashboard view
  </action>
  <verify>
    Run `cd /Users/vladcortex/co-founder/frontend && npx tsc --noEmit --pretty 2>&1 | head -20` — no TypeScript errors.
    Run `cd /Users/vladcortex/co-founder/frontend && npm run build 2>&1 | tail -5` — build succeeds.
  </verify>
  <done>
    Full flow wired: interview -> brief (with Deep Research 402 stub) -> Decision Gate 1 modal -> execution plan selection. Gate resolution routes to correct next step (proceed=plans, narrow/pivot=regenerate brief, park=archive). Dashboard shows gate and interview status. TypeScript compiles and build succeeds.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Visual Verification of Complete Phase 8 Flow</name>
  <action>
    Human verifies the complete Phase 8 Understanding Interview and Decision Gates flow:
    1. Understanding Interview backend (8 API endpoints, adaptive questions, Idea Brief generation)
    2. Decision Gate 1 backend (5 API endpoints, Proceed/Narrow/Pivot/Park resolution)
    3. Execution Plan backend (6 API endpoints, 409 enforcement, Deep Research 402 stub)
    4. Understanding Interview frontend (one-question-at-a-time, skeleton shimmer, back-navigation)
    5. Idea Brief display (expandable cards, confidence indicators, inline editing)
    6. Decision Gate modal (full-screen, rich option cards, narrow/pivot text fields)
    7. Execution Plan comparison table (4-row grid, recommended badge, full breakdown cards)
    8. Full flow integration and dashboard updates
  </action>
  <verify>
    1. Start the frontend dev server: `cd frontend && npm run dev`
    2. Start the backend dev server: `cd backend && uvicorn app.main:app --reload`
    3. Navigate to /understanding (or trigger from dashboard)
    4. Verify interview shows one question at a time with skeleton shimmer between questions
    5. Answer a few questions, then click a previous answer to edit — verify re-adaptation messaging
    6. Complete the interview and verify Idea Brief appears with expandable card sections
    7. Check each section has a confidence badge (Strong/Moderate/Needs depth)
    8. Try inline editing a section — verify optimistic update
    9. Click "Deep Research" button — verify 402 toast/message about CTO tier
    10. Click "Proceed to Decision" — verify full-screen modal appears blocking everything
    11. Review the 4 gate option cards (Proceed/Narrow/Pivot/Park) — check pros/cons/description
    12. Select "Narrow" — verify text field appears for narrowing description
    13. Select "Proceed" and confirm — verify execution plan comparison table appears
    14. Check comparison table has time/cost/risk/scope rows with recommended badge
    15. Check detailed option cards below table with full breakdown
    16. Select a plan — verify success state
    17. Return to dashboard — verify it reflects the new state
  </verify>
  <done>
    Human approves visual and interactive behavior of the complete Phase 8 flow. All 17 verification steps pass. Understanding interview, Idea Brief, Decision Gate 1, and Execution Plan selection work as designed.
  </done>
</task>

</tasks>

<verification>
- Full flow: interview -> brief -> gate -> plan selection works end-to-end
- Deep Research returns 402 with upgrade message
- Dashboard reflects understanding interview and gate status
- All TypeScript compiles without errors
- Build succeeds
</verification>

<success_criteria>
- Complete founder flow works: interview -> brief -> gate decision -> plan selection
- Each step transitions naturally to the next
- Deep Research button visible but gated at 402 (UNDR-06)
- Dashboard shows pending gate status and parked projects
- All locked decisions from CONTEXT.md honored in the final integration
- Human verification passes on visual and interactive behavior
</success_criteria>

<output>
After completion, create `.planning/phases/08-understanding-interview-decision-gates/08-06-SUMMARY.md`
</output>
