---
phase: 23-performance-baseline
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - marketing/src/app/globals.css
  - marketing/src/app/layout.tsx
  - marketing/src/app/(marketing)/layout.tsx
autonomous: true
requirements: [PERF-01, PERF-02, PERF-03]

must_haves:
  truths:
    - "Hero CSS classes (.hero-fade, .hero-fade-delayed) exist in globals.css with @starting-style blocks defining opacity 0->1 transitions"
    - "Space Grotesk font loads with display: block — no FOUT visible"
    - "CSS keyframe animations (marquee, pulse, float, rotate-gradient) stop for reduced-motion users"
    - "Framer Motion scroll-triggered animations respect OS reduced-motion setting via MotionConfig"
    - "Hover effects (button scale, card lift, link color) remain active for reduced-motion users"
  artifacts:
    - path: "marketing/src/app/globals.css"
      provides: "hero-fade CSS classes with @starting-style, reduced-motion @media block"
      contains: ".hero-fade"
    - path: "marketing/src/app/layout.tsx"
      provides: "Space Grotesk with display: block"
      contains: "display: \"block\""
    - path: "marketing/src/app/(marketing)/layout.tsx"
      provides: "MotionConfig reducedMotion wrapper"
      contains: "MotionConfig"
  key_links:
    - from: "marketing/src/app/globals.css"
      to: "hero component files"
      via: "CSS class names hero-fade and hero-fade-delayed"
      pattern: "hero-fade"
    - from: "marketing/src/app/(marketing)/layout.tsx"
      to: "all marketing page Framer Motion components"
      via: "MotionConfig reducedMotion=\"user\" wrapping main"
      pattern: "MotionConfig"
---

<objective>
Add CSS hero-fade classes, font-display: block, and reduced-motion support to the marketing site's global styles and layouts.

Purpose: Establish the CSS foundation that hero components will use (Plan 02), fix font loading flash, and ensure reduced-motion users get appropriate experience across the entire site.
Output: Updated globals.css with hero-fade classes and reduced-motion block, updated root layout.tsx with font-display: block, updated marketing layout.tsx with MotionConfig.
</objective>

<execution_context>
@/Users/vladcortex/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vladcortex/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-performance-baseline/23-RESEARCH.md
@marketing/src/app/globals.css
@marketing/src/app/layout.tsx
@marketing/src/app/(marketing)/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add hero-fade CSS classes and reduced-motion block to globals.css</name>
  <files>marketing/src/app/globals.css</files>
  <action>
Add two blocks at the END of globals.css (after the existing `.animate-pulse-border` block):

**Block 1 — Hero CSS fade classes with @starting-style:**
```css
/* Above-fold hero fade — CSS-only, LCP-safe */
.hero-fade {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 0.15s ease-out, transform 0.12s ease-out;
}

@starting-style {
  .hero-fade {
    opacity: 0;
    transform: translateY(6px);
  }
}

/* Stagger: subheading + CTA appear 75ms after headline */
.hero-fade-delayed {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 0.15s ease-out 0.075s, transform 0.12s ease-out 0.075s;
}

@starting-style {
  .hero-fade-delayed {
    opacity: 0;
    transform: translateY(6px);
  }
}
```

**Block 2 — Global reduced-motion block:**
```css
/* Reduced motion: stop CSS keyframe animations (marquee, pulse, float, rotate-gradient)
   Preserve CSS transitions so hover effects (button scale, card lift, link color) remain active.
   Do NOT set transition-duration — user decision requires hover effects to stay. */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    scroll-behavior: auto !important;
  }
}
```

**Critical:** Do NOT use `animation: none` (would snap elements to initial/invisible state). Do NOT set `transition-duration: 0.01ms` (would kill hover effects — violates user decision). Only target `animation-duration` and `animation-iteration-count`.
  </action>
  <verify>
1. Run `grep -c "hero-fade" marketing/src/app/globals.css` — should return 6+ (class name appears in both normal and @starting-style blocks)
2. Run `grep -c "prefers-reduced-motion" marketing/src/app/globals.css` — should return 1
3. Run `grep "animation-duration: 0.01ms" marketing/src/app/globals.css` — should match
4. Run `grep "transition-duration" marketing/src/app/globals.css` — should NOT match inside the reduced-motion block (transitions preserved)
5. Run `cd marketing && npm run build` — should succeed with no errors
  </verify>
  <done>globals.css contains .hero-fade and .hero-fade-delayed classes with @starting-style blocks, and a @media (prefers-reduced-motion: reduce) block that stops keyframe animations while preserving CSS transitions</done>
</task>

<task type="auto">
  <name>Task 2: Add font-display: block to Space Grotesk and wrap marketing layout in MotionConfig</name>
  <files>marketing/src/app/layout.tsx, marketing/src/app/(marketing)/layout.tsx</files>
  <action>
**File 1 — marketing/src/app/layout.tsx:**

Add `display: "block"` to the Space_Grotesk configuration object. The current config is:
```tsx
const spaceGrotesk = Space_Grotesk({
  subsets: ["latin"],
  variable: "--font-space-grotesk",
  weight: ["300", "400", "500", "600", "700"],
});
```

Change to:
```tsx
const spaceGrotesk = Space_Grotesk({
  subsets: ["latin"],
  variable: "--font-space-grotesk",
  weight: ["300", "400", "500", "600", "700"],
  display: "block",
});
```

Do NOT change anything else in this file. Keep all 5 weights (all used across components). Latin subset only (site is English-only). `preload: true` is already the default — do not add it explicitly.

**File 2 — marketing/src/app/(marketing)/layout.tsx:**

1. Add import at top: `import { MotionConfig } from "framer-motion";`
2. Add `"use client";` directive at the very top of the file (MotionConfig is a client component)
3. Wrap `<main>{children}</main>` with `<MotionConfig reducedMotion="user">...</MotionConfig>`

The result should be:
```tsx
"use client";

import { MotionConfig } from "framer-motion";
import { Navbar } from "@/components/marketing/navbar";
import { Footer } from "@/components/marketing/footer";

export default function MarketingLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div className="font-display min-h-screen bg-obsidian text-white">
      <Navbar />
      <MotionConfig reducedMotion="user">
        <main>{children}</main>
      </MotionConfig>
      <Footer />
    </div>
  );
}
```

**What `reducedMotion="user"` does:** When the user's OS has "Reduce Motion" enabled, Framer Motion disables transform (x, y, rotate, scale) and layout animations but preserves opacity transitions — resulting in cross-fades instead of sliding/bouncing. This matches the user's locked decision.

**Note:** The `metadata` export in the marketing layout file does not exist (metadata is in root layout.tsx and individual page files). Adding "use client" is safe here — it only affects this layout component, not page-level metadata exports.
  </action>
  <verify>
1. Run `grep 'display: "block"' marketing/src/app/layout.tsx` — should match
2. Run `grep 'MotionConfig' marketing/src/app/\\(marketing\\)/layout.tsx` — should match twice (import + usage)
3. Run `grep 'use client' marketing/src/app/\\(marketing\\)/layout.tsx` — should match
4. Run `cd marketing && npm run build` — should succeed with no errors
  </verify>
  <done>Space Grotesk loads with display: block (no FOUT), and the marketing layout wraps main content in MotionConfig reducedMotion="user" so all Framer Motion components respect OS reduced-motion settings</done>
</task>

</tasks>

<verification>
1. `cd marketing && npm run build` succeeds with zero errors
2. globals.css contains `.hero-fade` and `.hero-fade-delayed` with `@starting-style` blocks
3. globals.css contains `@media (prefers-reduced-motion: reduce)` block that only targets `animation-duration` (not `transition-duration`)
4. layout.tsx Space_Grotesk config includes `display: "block"`
5. Marketing layout.tsx imports and uses `MotionConfig reducedMotion="user"` around `<main>`
</verification>

<success_criteria>
- Build passes with no errors
- CSS hero-fade classes are ready for Plan 02 to apply to hero components
- Font displays as "block" instead of default "swap"
- Reduced-motion CSS block stops keyframe animations while preserving hover transitions
- MotionConfig wraps all marketing pages' Framer Motion components
</success_criteria>

<output>
After completion, create `.planning/phases/23-performance-baseline/23-01-SUMMARY.md`
</output>
